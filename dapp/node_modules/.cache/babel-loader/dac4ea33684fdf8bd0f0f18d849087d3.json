{"ast":null,"code":"var _jsxFileName = \"/home/pablo/Desktop/DAO/dapp/src/components/dao/Daolist/Daowatch.js\",\n  _s = $RefreshSig$();\nimport { drizzleReactHooks } from '@drizzle/react-plugin';\nimport { Link } from 'react-router-dom';\nimport web3 from 'web3';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst {\n  useDrizzle,\n  useDrizzleState\n} = drizzleReactHooks;\nconst Daowatch = ({\n  DaoIndex\n}) => {\n  _s();\n  const {\n    useCacheCall\n  } = useDrizzle();\n  const drizzleState = useDrizzleState(state => state);\n  const {\n    drizzle\n  } = useDrizzle();\n  const address = drizzleState.accounts[0];\n  const balance = drizzleState.accountBalances[address];\n  const oz_states = ['Pending', 'Active', 'Canceled', 'Defeated', 'Succeeded', 'Queued', 'Expired', 'Executed'];\n\n  // Función para obtener el estado basado en el valor de propState\n  const getPropState = propState => {\n    return oz_states[propState] || 'Unknown'; // Devolvemos el estado correspondiente o 'Unknown' si no se encuentra\n  };\n\n  let {\n    addr,\n    datos,\n    propState,\n    proposalData\n  } = useCacheCall(['GovernorContract'], call => {\n    const addr = call('GovernorContract', 'proposes', DaoIndex);\n    const datos = addr && call('GovernorContract', 'datosPropose', addr);\n    const propState = addr && datos && call('GovernorContract', 'state', datos.id);\n    const proposalData = addr && datos && propState && call('GovernorContract', 'datosPropose', datos.id);\n    return {\n      addr,\n      datos,\n      propState,\n      proposalData\n    };\n  });\n\n  // Renderizar el elemento apropiado basado en propState\n  const renderActionElement = () => {\n    if (propState == 1 || propState == 0) {\n      // Estado \"Active\"\n      return /*#__PURE__*/_jsxDEV(Link, {\n        to: `/dao/${DaoIndex}`,\n        children: \"Votar\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 14\n      }, this);\n    } else if (propState == 4) {\n      // Estado \"Succeeded\"\n      return /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: ejecutarPropuesta,\n        children: \"Ejecutar\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 14\n      }, this);\n    } else {\n      return null;\n    }\n  };\n\n  // Función para ejecutar la propuesta (llamar a la función \"ejecutarPropuesta\" según tu contrato)\n  const ejecutarPropuesta = async () => {\n    try {\n      // Lógica para ejecutar la propuesta aquí, según el contrato\n      const queueTx = drizzle.contracts.GovernorContract.methods.queue.cacheSend([proposalData.targets], [0], [proposalData.calldatas], web3.utils.sha3(proposalData.description));\n      const executeTx = drizzle.contracts.GovernorContract.methods.execute.cacheSend([proposalData.targets], [0], [proposalData.calldatas], web3.utils.sha3(proposalData.description));\n    } catch (error) {\n      console.log('Error al ejecutar la propuesta:', error);\n    }\n  };\n\n  /*\n  \n  let { addr, datos, proposalData } = useCacheCall(\n      ['GovernorContract'],\n      (call) => {\n        const addr = call('GovernorContract', 'proposes', index);\n        const datos = addr && call('GovernorContract', 'datosPropose', addr);\n        const proposalData = addr && datos && call('GovernorContract', 'datosPropose', datos.id);\n        return { addr, datos, proposalData };\n      }\n    );\n  \n    // Función para manejar el envío del voto\n    const handleVotoSubmit = (event) => {\n      event.preventDefault();\n  \n      \n  \n        const proposeTx = drizzle.contracts.GovernorContract.methods.castVoteWithReason.cacheSend(datos.id,voto,cuadroTexto);\n  \n  \n        // Reiniciamos los estados para la próxima votación\n        setVoto(null);\n        setCuadroTexto(\"\");\n      }\n    };\n  \n  */\n\n  return /*#__PURE__*/_jsxDEV(\"tr\", {\n    children: [/*#__PURE__*/_jsxDEV(\"th\", {\n      children: [\"A\", /*#__PURE__*/_jsxDEV(\"sub\", {\n        children: DaoIndex\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 12\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n      children: datos === null || datos === void 0 ? void 0 : datos.description\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n      children: getPropState(propState)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n      children: renderActionElement()\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 7\n    }, this)]\n  }, 'Dao-' + DaoIndex, true, {\n    fileName: _jsxFileName,\n    lineNumber: 109,\n    columnNumber: 5\n  }, this);\n};\n_s(Daowatch, \"qoMYnUb5JGD2qKq0WB1vf9dm/Pc=\", true, function () {\n  return [useDrizzle, useDrizzleState, useDrizzle];\n});\n_c = Daowatch;\nexport default Daowatch;\nvar _c;\n$RefreshReg$(_c, \"Daowatch\");","map":{"version":3,"names":["drizzleReactHooks","Link","web3","jsxDEV","_jsxDEV","useDrizzle","useDrizzleState","Daowatch","DaoIndex","_s","useCacheCall","drizzleState","state","drizzle","address","accounts","balance","accountBalances","oz_states","getPropState","propState","addr","datos","proposalData","call","id","renderActionElement","to","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","ejecutarPropuesta","queueTx","contracts","GovernorContract","methods","queue","cacheSend","targets","calldatas","utils","sha3","description","executeTx","execute","error","console","log","_c","$RefreshReg$"],"sources":["/home/pablo/Desktop/DAO/dapp/src/components/dao/Daolist/Daowatch.js"],"sourcesContent":["import { drizzleReactHooks } from '@drizzle/react-plugin';\nimport { Link } from 'react-router-dom';\nimport web3 from 'web3';\n\nconst { useDrizzle, useDrizzleState } = drizzleReactHooks;\n\nconst Daowatch = ({ DaoIndex }) => {\n  const { useCacheCall } = useDrizzle();\n  const drizzleState = useDrizzleState((state) => state);\n  const { drizzle } = useDrizzle();\n  const address = drizzleState.accounts[0];\n  const balance = drizzleState.accountBalances[address];\n\n  \n\n  const oz_states = [\n    'Pending',\n    'Active',\n    'Canceled',\n    'Defeated',\n    'Succeeded',\n    'Queued',\n    'Expired',\n    'Executed',\n  ];\n\n  // Función para obtener el estado basado en el valor de propState\n  const getPropState = (propState) => {\n    return oz_states[propState] || 'Unknown'; // Devolvemos el estado correspondiente o 'Unknown' si no se encuentra\n  };\n\n  let { addr, datos, propState, proposalData } = useCacheCall(\n    ['GovernorContract'],\n    (call) => {\n      const addr = call('GovernorContract', 'proposes', DaoIndex);\n      const datos = addr && call('GovernorContract', 'datosPropose', addr);\n      const propState = addr && datos && call('GovernorContract', 'state', datos.id);\n      const proposalData= addr && datos && propState && call('GovernorContract', 'datosPropose', datos.id);\n      return { addr, datos, propState, proposalData };\n    }\n  );\n    \n    \n  // Renderizar el elemento apropiado basado en propState\n  const renderActionElement = () => {\n    if (propState == 1 || propState == 0) {\n      // Estado \"Active\"\n      return <Link to={`/dao/${DaoIndex}`}>Votar</Link>;\n    } \n    \n    else if (propState == 4) {\n      // Estado \"Succeeded\"\n      return <button onClick={ejecutarPropuesta}>Ejecutar</button>;\n    } else {\n      return (null);\n    }\n  };\n\n  // Función para ejecutar la propuesta (llamar a la función \"ejecutarPropuesta\" según tu contrato)\n  const ejecutarPropuesta = async () => {\n    try {\n      // Lógica para ejecutar la propuesta aquí, según el contrato\n      const queueTx = drizzle.contracts.GovernorContract.methods.queue.cacheSend([proposalData.targets],[0],[proposalData.calldatas], web3.utils.sha3(proposalData.description));\n\n\n      const executeTx = drizzle.contracts.GovernorContract.methods.execute.cacheSend([proposalData.targets],[0],[proposalData.calldatas], web3.utils.sha3(proposalData.description));\n\n\n    } catch (error) {\n      console.log('Error al ejecutar la propuesta:', error);\n    }\n  };\n\n\n\n\n/*\n\nlet { addr, datos, proposalData } = useCacheCall(\n    ['GovernorContract'],\n    (call) => {\n      const addr = call('GovernorContract', 'proposes', index);\n      const datos = addr && call('GovernorContract', 'datosPropose', addr);\n      const proposalData = addr && datos && call('GovernorContract', 'datosPropose', datos.id);\n      return { addr, datos, proposalData };\n    }\n  );\n\n  // Función para manejar el envío del voto\n  const handleVotoSubmit = (event) => {\n    event.preventDefault();\n\n    \n\n      const proposeTx = drizzle.contracts.GovernorContract.methods.castVoteWithReason.cacheSend(datos.id,voto,cuadroTexto);\n\n\n      // Reiniciamos los estados para la próxima votación\n      setVoto(null);\n      setCuadroTexto(\"\");\n    }\n  };\n\n*/\n\n\n\n  return (\n    <tr key={'Dao-' + DaoIndex}>\n      <th>A<sub>{DaoIndex}</sub></th>\n      <td>{datos?.description}</td>\n      <td>{getPropState(propState)}</td>\n      <td>{renderActionElement()}</td>\n    </tr>\n  );\n};\n\nexport default Daowatch;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}